"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7362],{79417:(le,z,a)=>{a.d(z,{l:()=>bt});var s=a(68404),D=a(36635),Z=a(32294),T=a(46732),Y=a(58252),J=a(56991);function d({children:t,width:e,height:r,onLoad:n,onChange:o}){const i=(0,J.L)(),[l,h]=(0,s.useState)(!1),[u,E]=(0,s.useState)(!1),O=(0,s.useRef)(null);return(0,Y.Z)(()=>{d.addCallback(i,j=>{!l&&j.isIntersecting&&(h(!0),n?.()),E(j.isIntersecting),o?.(j.isIntersecting)});const N=O.current;return N&&d.observer.observe(N),()=>{delete d.callbacks[i],N&&d.observer.unobserve(N),Object.keys(d.callbacks).length===0&&d.observer.disconnect()}}),s.createElement("div",{id:i,ref:O,style:{width:e,height:r}},l&&(typeof t=="function"?t({isInView:u}):t))}d.callbacks={},d.addCallback=(t,e)=>d.callbacks[t]=e,d.observer=new IntersectionObserver(t=>{for(const e of t)d.callbacks[e.target.id](e)},{rootMargin:"100px"});var b=a(9085),L=a.n(b),f=a(53376),c=a(49922),C=a(69311),p=a(68183),y=a(11484),M=a(37932),H=a(38208),S=a(47694),m=a(84952),I=a(73952);function W(t){return/(d-solo|dashboard-solo)/.test(t?.toLowerCase())}function K(t,e){return Boolean(e.find(r=>r.id==="apps")?.children?.find(r=>r.id===`plugin-page-${t}`)?.children?.some(r=>r.url?.endsWith(`/a/${t}`)))}var U=a(19349),_=a(41959),X=a(20308),x=a(41818),Q=a(39653),ne=a(69600),k=a(9892),re=a(23309),se=a(72648),de=a(6554),ae=a(39904),fe=a(3630),P=a(38484),A=a(71698),G=a(64319);function V({panelLinks:t,onShowPanelLinks:e}){const r=(0,se.wW)(v),n=()=>{const o=e();return s.createElement(P.v,null,o?.map((i,l)=>s.createElement(P.v.Item,{key:l,label:i.title,url:i.href,target:i.target,onClick:i.onClick})))};if(t.length===1){const o=e()[0];return s.createElement(H.fm.TitleItem,{href:o.href,onClick:o.onClick,target:o.target,title:o.title},s.createElement(ae.J,{name:"external-link-alt",size:"md"}))}else return s.createElement(A.L,{overlay:n},s.createElement(G.h,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links",className:r.menuTrigger}))}const v=t=>({menuTrigger:(0,k.css)({height:"100%",background:"inherit",border:"none",borderRadius:`${t.shape.borderRadius()}`,cursor:"context-menu"})});var ee=a(85419);const ce=({notice:t,onClick:e})=>{const r=(0,se.wW)(ge),n=t.severity==="error"||t.severity==="warning"?"exclamation-triangle":"info-circle";return t.inspect&&e?s.createElement(G.h,{className:r.notice,icon:n,iconSize:"md",key:t.severity,tooltip:t.text,onClick:o=>e(o,t.inspect)}):t.link?s.createElement("a",{className:r.notice,"aria-label":t.text,href:t.link,target:"_blank",rel:"noreferrer"},s.createElement(ae.J,{name:n,style:{marginRight:"8px"},size:"md"})):s.createElement(de.u,{key:t.severity,content:t.text},s.createElement("span",{className:r.iconTooltip},s.createElement(ae.J,{name:n,size:"md"})))},ge=t=>({notice:(0,k.css)({background:"inherit",border:"none",borderRadius:t.shape.borderRadius()}),iconTooltip:(0,k.css)({color:`${t.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${t.shape.borderRadius()}`,padding:`${t.spacing(0,1)}`,height:` ${t.spacing(t.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,ee.getFocusStyles)(t),zIndex:1},"&: focus:not(:focus-visible)":(0,ee.getMouseFocusStyles)(t),"&:hover ":{boxShadow:`${t.shadows.z1}`,color:`${t.colors.text.primary}`,background:`${t.colors.background.secondary}`}})}),Ee=({frames:t,panelId:e})=>{const r=(0,s.useCallback)((o,i)=>{o.stopPropagation(),M.E1.partial({inspect:e,inspectTab:i})},[e]),n={};for(const o of t)if(!(!o.meta||!o.meta.notices))for(const i of o.meta.notices)n[i.severity]=i;return s.createElement(s.Fragment,null,Object.values(n).map(o=>s.createElement(ce,{notice:o,onClick:r,key:o.severity})))};function ve(t){const{alertState:e,data:r,panelId:n,onShowPanelLinks:o,panelLinks:i}=t,l=(0,se.wW)(xe),h=s.createElement(de.u,{content:`alerting is ${e}`},s.createElement(H.fm.TitleItem,{className:(0,k.cx)({[l.ok]:e===re.Z.OK,[l.pending]:e===re.Z.Pending,[l.alerting]:e===re.Z.Alerting})},s.createElement(ae.J,{name:e==="alerting"?"heart-break":"heart",className:"panel-alert-icon",size:"md"}))),u=s.createElement(s.Fragment,null,r.request&&r.request.timeInfo&&s.createElement(de.u,{content:s.createElement(fe.IF,{timeRange:r.request?.range,timeZone:r.request?.timezone})},s.createElement(H.fm.TitleItem,{className:l.timeshift},s.createElement(ae.J,{name:"clock-nine",size:"md"})," ",r.request?.timeInfo)));return s.createElement(s.Fragment,null,i&&i.length>0&&o&&s.createElement(V,{onShowPanelLinks:o,panelLinks:i}),s.createElement(Ee,{panelId:n,frames:r.series}),u,e&&h)}const xe=t=>({ok:(0,k.css)({color:t.colors.success.text}),pending:(0,k.css)({color:t.colors.warning.text}),alerting:(0,k.css)({color:t.colors.error.text}),timeshift:(0,k.css)({color:t.colors.text.link,gap:t.spacing(.5),whiteSpace:"nowrap","&:hover":{color:t.colors.emphasize(t.colors.text.link,.03)}})});function oe(t){let e=!1;function r(){return t.data.request&&t.data.request.timeInfo?!1:!t.panel.hasTitle()}const n=()=>{const w=(0,X.J)().replace(t.panel.description,t.panel.scopedVars),R=(0,_.a)(w);return e||((0,x.ff)("dashboards_panelheader_description_displayed"),e=!0),R},o=()=>{const w=(0,ne.H)(t.panel);if(!w)return[];const R=w&&w.getLinks(t.panel.replaceVariables);return R.map(ie=>({...ie,onClick:(...pe)=>{(0,x.ff)("dashboards_panelheader_datalink_clicked",{has_multiple_links:R.length>1}),ie.onClick?.(...pe)}}))},i=(w,R)=>{w.stopPropagation(),M.E1.partial({inspect:t.panel.id,inspectTab:R})},l=w=>{w.stopPropagation(),M.E1.partial({inspect:t.panel.id,inspectTab:Q.q.Error}),(0,x.ff)("dashboards_panelheader_statusmessage_clicked")},h=()=>{t.panel.getQueryRunner().cancelQuery(),(0,x.ff)("dashboards_panelheader_cancelquery_clicked",{data_state:t.data.state})},u=t.plugin.noPadding?"none":"md",E=t.data.alertState?.state,N=(t.panel.links&&t.panel.links.length>0&&o||t.data.series.length>0&&t.data.series.some(w=>(w.meta?.notices?.length??0)>0)||t.data.request&&t.data.request.timeInfo||E)&&s.createElement(ve,{alertState:E,data:t.data,panelId:t.panel.id,panelLinks:t.panel.links,onShowPanelLinks:o}),j=t.panel.description?n():void 0,q=t.isViewing||t.isEditing?"":"grid-drag-handle",$=t.panel.getDisplayTitle();return{hasOverlayHeader:r,onShowPanelDescription:n,onShowPanelLinks:o,onOpenInspector:i,onOpenErrorInspect:l,onCancelQuery:h,padding:u,description:j,dragClass:q,title:$,titleItems:N,onOpenMenu:()=>{(0,x.ff)("dashboards_panelheader_menu",{item:"menu"})}}}var Ve=a(94437),Be=a(53821);const ze=({state:t,onClick:e})=>{const r=(0,se.wW)(Ke);return t===c.Gu.Loading?s.createElement("div",{className:"panel-loading",onClick:e},s.createElement(de.u,{content:"Cancel query"},s.createElement(ae.J,{className:"panel-loading__spinner spin-clockwise",name:"sync"}))):t===c.Gu.Streaming?s.createElement("div",{className:"panel-loading",onClick:e},s.createElement("div",{title:"Streaming (click to stop)",className:r.streamIndicator})):null};function Ke(t){return{streamIndicator:k.css`
      width: 10px;
      height: 10px;
      background: ${t.colors.text.disabled};
      box-shadow: 0 0 2px ${t.colors.text.disabled};
      border-radius: 50%;
      position: relative;
      top: 6px;
      right: 1px;
    `}}function Qe({children:t,onOpenMenu:e,...r}){const[n,o]=(0,s.useState)({x:0,y:0}),[i,l]=(0,s.useState)(!1),h=(0,s.useCallback)(E=>{$e(n,Oe(E))&&(l(!i),i&&e?.())},[n,i,l,e]),u=(0,s.useCallback)(E=>{o(Oe(E))},[o]);return s.createElement("header",{...r,className:"panel-title-container",onClick:h,onMouseDown:u},t({panelMenuOpen:i,closeMenu:()=>l(!1)}))}function $e(t,e,r=3.5){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)<=r}function Oe(t){return{x:t.clientX,y:t.clientY}}var Ze=a(79860);class Je extends s.PureComponent{constructor(){super(...arguments),this.renderItems=(e,r=!1)=>s.createElement("ul",{className:L()("dropdown-menu","dropdown-menu--menu","panel-menu",this.props.itemsClassName),style:this.props.style,role:r?"":"menu"},e.map((n,o)=>s.createElement(Ze.u,{key:`${n.text}${o}`,type:n.type,text:n.text,iconClassName:n.iconClassName,onClick:n.onClick,shortcut:n.shortcut,href:n.href},n.subMenu&&this.renderItems(n.subMenu,!0))))}render(){return s.createElement("div",{className:L()("panel-menu-container","dropdown","open",this.props.className)},this.renderItems(this.props.items))}}function Ge({items:t}){const e=r=>r.map(n=>n.type==="divider"?s.createElement(P.v.Divider,{key:n.text}):s.createElement(P.v.Item,{key:n.text,label:n.text,icon:n.iconClassName,childItems:n.subMenu?e(n.subMenu):void 0,url:n.href,onClick:n.onClick,shortcut:n.shortcut,testId:p.wl.components.Panels.Panel.menuItems(n.text)}));return s.createElement(P.v,null,e(t))}var je=a(81168),Ye=a(21830),Xe=a(86647),qe=a(54665),_e=a(36032),B=a(35287),Me=a(82002),et=a(55935),he=a(2476),tt=a(6297),Te=a(3153),nt=a(48197);function at(t,e,r){const n=g=>{g.preventDefault(),M.E1.partial({viewPanel:e.id}),(0,x.ff)("dashboards_panelheader_menu",{item:"view"})},o=g=>{g.preventDefault(),M.E1.partial({editPanel:e.id}),(0,x.ff)("dashboards_panelheader_menu",{item:"edit"})},i=g=>{g.preventDefault(),(0,he.Po)(t,e),(0,x.ff)("dashboards_panelheader_menu",{item:"share"})},l=g=>{g.preventDefault(),(0,he.Kq)(t,e),(0,x.ff)("dashboards_panelheader_menu",{item:"createLibraryPanel"})},h=g=>{g.preventDefault(),(0,he.oe)(e),(0,x.ff)("dashboards_panelheader_menu",{item:"unlinkLibraryPanel"})},u=g=>{M.E1.partial({inspect:e.id,inspectTab:g}),(0,x.ff)("dashboards_panelheader_menu",{item:"inspect",tab:g??Q.q.Data})},E=g=>{g.preventDefault()},O=g=>{g.preventDefault(),(0,he.jN)(t,e),(0,x.ff)("dashboards_panelheader_menu",{item:"duplicate"})},N=g=>{g.preventDefault(),(0,he.bY)(e),(0,x.ff)("dashboards_panelheader_menu",{item:"copy"})},j=g=>{g.preventDefault(),(0,he.WJ)(t,e,!0),(0,x.ff)("dashboards_panelheader_menu",{item:"remove"})},q=g=>{g.preventDefault();const te=g.ctrlKey||g.metaKey?me=>window.open(`${S.ZP.appSubUrl}${me}`):void 0;Te.h.dispatch((0,nt.m$)(e,{getDataSourceSrv:Xe.F,getTimeSrv:U.$t,getExploreUrl:et.H6,openInNewWindow:te})),(0,x.ff)("dashboards_panelheader_menu",{item:"explore"})},$=g=>{g.preventDefault(),(0,he.qw)(e),(0,x.ff)("dashboards_panelheader_menu",{item:"toggleLegend"})},F=[];e.isEditing||F.push({text:(0,B.t)("panel.header-menu.view","View"),iconClassName:"eye",onClick:n,shortcut:"v"}),t.canEditPanel(e)&&!e.isEditing&&F.push({text:(0,B.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",onClick:o,shortcut:"e"}),F.push({text:(0,B.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:i,shortcut:"p s"}),Me.Vt.hasAccessToExplore()&&!(e.plugin&&e.plugin.meta.skipDataQuery)&&F.push({text:(0,B.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",onClick:q,shortcut:"x"});const w=[];e.plugin&&!e.plugin.meta.skipDataQuery&&(w.push({text:(0,B.t)("panel.header-menu.inspect-data","Data"),onClick:g=>u(Q.q.Data)}),t.meta.canEdit&&w.push({text:(0,B.t)("panel.header-menu.query","Query"),onClick:g=>u(Q.q.Query)})),w.push({text:(0,B.t)("panel.header-menu.inspect-json","Panel JSON"),onClick:g=>u(Q.q.JSON)}),F.push({type:"submenu",text:(0,B.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",onClick:g=>{const te=g.currentTarget,me=g.target,ue=me.closest('[role="menuitem"]');(me===te||ue===te)&&u()},shortcut:"i",subMenu:w});const R=[],ie=t.canEditPanel(e);if(e.isViewing||e.isEditing||(ie?(R.push({text:(0,B.t)("panel.header-menu.duplicate","Duplicate"),onClick:O,shortcut:"p d"}),R.push({text:(0,B.t)("panel.header-menu.copy","Copy"),onClick:N}),(0,tt.V)(e)?R.push({text:(0,B.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),onClick:h}):R.push({text:(0,B.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:l})):Me.Vt.isEditor&&R.push({text:(0,B.t)("panel.header-menu.copy","Copy"),onClick:N})),r){const g=r.getScope(),te=g.$$childHead.ctrl,me=te.getExtendedMenu();for(const ue of me){const We={text:ue.text,href:ue.href,shortcut:ue.shortcut};ue.click&&(We.onClick=()=>{g.$eval(ue.click,{ctrl:te})}),R.push(We)}}e.options.legend&&R.push({text:e.options.legend.showLegend?(0,B.t)("panel.header-menu.hide-legend","Hide legend"):(0,B.t)("panel.header-menu.show-legend","Show legend"),onClick:$,shortcut:"p l"}),e.isEditing&&(R.length=0),ie&&e.plugin&&!e.plugin.meta.skipDataQuery&&R.push({text:(0,B.t)("panel.header-menu.get-help","Get help"),onClick:g=>u(Q.q.Help)}),R.length&&F.push({type:"submenu",text:(0,B.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:R,onClick:E});const{extensions:pe}=(0,qe.I)({extensionPointId:Ye.y.DashboardPanelMenu,context:rt(e,t)});if(pe.length>0&&!e.isEditing){const g=[];for(const te of pe)if((0,_e.c)(te)){g.push({text:st(te.title,25),href:te.path,onClick:te.onClick});continue}F.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:g})}return t.canEditPanel(e)&&!e.isEditing&&!e.isViewing&&(F.push({type:"divider",text:""}),F.push({text:(0,B.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:j,shortcut:"p r"})),F}function st(t,e){return t.length<e?t:`${t.slice(0,e-3).trimEnd()}...`}function rt(t,e){return{id:t.id,pluginId:t.type,title:t.title,timeRange:e.time,timeZone:e.timezone,dashboard:{uid:e.uid,title:e.title,tags:Array.from(e.tags)},targets:t.targets}}function Re({panel:t,dashboard:e,loadingState:r,children:n}){const[o,i]=(0,s.useState)([]),l=(0,je.useSelector)(h=>(0,I.i)(h,t)?.angularComponent);return(0,s.useEffect)(()=>{i(at(e,t,l))},[e,t,l,r,i]),n({items:o})}function ot({panel:t,dashboard:e,loadingState:r,style:n,menuItemsClassName:o,menuWrapperClassName:i}){return s.createElement(Re,{panel:t,dashboard:e,loadingState:r},({items:l})=>s.createElement(Je,{className:i,itemsClassName:o,style:n,items:l}))}function be({style:t,panel:e,dashboard:r,loadingState:n}){return s.createElement(Re,{panel:e,dashboard:r,loadingState:n},({items:o})=>s.createElement(Ge,{style:t,items:o}))}function Le({panel:t,error:e,isViewing:r,isEditing:n,data:o,alertState:i,dashboard:l}){const h=()=>t.getQueryRunner().cancelQuery(),u=t.getDisplayTitle(),E=(0,k.cx)("panel-header",r||n?"":"grid-drag-handle"),O=(0,se.wW)(it),N=()=>{(0,x.ff)("dashboards_panelheader_menu",{item:"menu"})};return s.createElement(s.Fragment,null,s.createElement(ze,{state:o.state,onClick:h}),s.createElement(Be.Z,{panel:t,title:t.title,description:t.description,scopedVars:t.scopedVars,links:(0,ne.H)(t),error:e}),s.createElement("div",{className:E},s.createElement(Qe,{"data-testid":p.wl.components.Panels.Panel.title(u),onOpenMenu:N},({closeMenu:j,panelMenuOpen:q})=>s.createElement(Ve.L,{onClick:j,parent:document},s.createElement("div",{className:"panel-title"},s.createElement(Ee,{frames:o.series,panelId:t.id}),i?s.createElement(ae.J,{name:i==="alerting"?"heart-break":"heart",className:"icon-gf panel-alert-icon",style:{marginRight:"4px"},size:"sm"}):null,s.createElement("h2",{className:O.titleText},u),!l.meta.publicDashboardAccessToken&&s.createElement("div",{"data-testid":"panel-dropdown"},s.createElement(ae.J,{name:"angle-down",className:"panel-menu-toggle"}),q?s.createElement(ot,{panel:t,dashboard:l}):null),o.request&&o.request.timeInfo&&s.createElement("span",{className:"panel-time-info"},s.createElement(ae.J,{name:"clock-nine",size:"sm"})," ",o.request.timeInfo))))))}const it=t=>({titleText:k.css`
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      max-width: calc(100% - 38px);
      cursor: pointer;
      font-weight: ${t.typography.fontWeightMedium};
      font-size: ${t.typography.body.fontSize};
      margin: 0;

      &:hover {
        color: ${t.colors.text.primary};
      }
      .panel-has-alert & {
        max-width: calc(100% - 54px);
      }
    `});class lt extends s.PureComponent{constructor(e){super(e),this.element=null,this.timeSrv=(0,U.$t)(),this.subs=new f.w0,this.state={data:{state:c.Gu.NotStarted,series:[],timeRange:(0,C.JK)()}}}componentDidMount(){const{panel:e}=this.props;this.loadAngularPanel();const r=e.getQueryRunner();this.subs.add(r.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:n=>this.onPanelDataUpdate(n)}))}onPanelDataUpdate(e){let r;if(e.state===c.Gu.Error){const{error:n}=e;n&&r!==n.message&&(r=n.message)}this.setState({data:e,errorMessage:r})}componentWillUnmount(){this.subs.unsubscribe(),this.props.angularComponent&&this.props.angularComponent?.destroy()}componentDidUpdate(e,r){const{plugin:n,height:o,width:i,panel:l}=this.props;e.plugin!==n&&this.loadAngularPanel(),(e.width!==i||e.height!==o)&&this.scopeProps&&(this.scopeProps.size.height=this.getInnerPanelHeight(),this.scopeProps.size.width=this.getInnerPanelWidth(),l.render())}getInnerPanelHeight(){const{plugin:e,height:r}=this.props,{theme:n}=S.ZP,o=this.hasOverlayHeader()?0:n.panelHeaderHeight,i=e.noPadding?0:n.panelPadding;return r-o-i*2-m.QO}getInnerPanelWidth(){const{plugin:e,width:r}=this.props,{theme:n}=S.ZP,o=e.noPadding?0:n.panelPadding;return r-o*2-m.QO}loadAngularPanel(){const{panel:e,dashboard:r,setPanelAngularComponent:n}=this.props;if(!this.element)return;const o=(0,y.w)(),i='<plugin-component type="panel" class="panel-height-helper"></plugin-component>';this.scopeProps={panel:e,dashboard:r,size:{width:this.getInnerPanelWidth(),height:this.getInnerPanelHeight()}},n({key:e.key,angularComponent:o.load(this.element,this.scopeProps,i)})}hasOverlayHeader(){const{panel:e}=this.props,{data:r}=this.state;return r.request&&r.request.timeInfo?!1:!e.hasTitle()}render(){const{dashboard:e,panel:r,isViewing:n,isEditing:o,plugin:i}=this.props,{errorMessage:l,data:h}=this.state,{transparent:u}=r,E=h.alertState?.state,O=oe({...this.props,data:h}),N=L()({"panel-container":!0,"panel-container--absolute":W(M.E1.getLocation().pathname),"panel-container--transparent":u,"panel-container--no-title":this.hasOverlayHeader(),"panel-has-alert":r.alert!==void 0,[`panel-alert-state--${E}`]:E!==void 0}),j=L()({"panel-content":!0,"panel-content--no-padding":i.noPadding});if(S.ZP.featureToggles.newPanelChromeUI){const q=(r.gridPos?.y??0)===0?-16:void 0,$=s.createElement("div",{"data-testid":"panel-dropdown"},s.createElement(be,{panel:r,dashboard:e,loadingState:h.state}));return s.createElement(H.fm,{width:this.props.width,height:this.props.height,title:O.title,loadingState:h.state,statusMessage:l,statusMessageOnClick:O.onOpenErrorInspect,description:O.description,titleItems:O.titleItems,menu:this.props.hideMenu?void 0:$,dragClass:O.dragClass,dragClassCancel:"grid-drag-cancel",padding:O.padding,hoverHeaderOffset:q,hoverHeader:O.hasOverlayHeader(),displayMode:u?"transparent":"default",onCancelQuery:O.onCancelQuery,onOpenMenu:O.onOpenMenu},()=>s.createElement("div",{ref:F=>this.element=F,className:"panel-height-helper"}))}else return s.createElement("div",{className:N,"data-testid":p.wl.components.Panels.Panel.title(r.title),"aria-label":p.wl.components.Panels.Panel.containerByTitle(r.title)},s.createElement(Le,{panel:r,dashboard:e,title:r.title,description:r.description,links:r.links,error:l,isViewing:n,isEditing:o,data:h,alertState:E}),s.createElement("div",{className:j},s.createElement("div",{ref:q=>this.element=q,className:"panel-height-helper"})))}}const dt=(t,e)=>({angularComponent:(0,I.i)(t,e.panel)?.angularComponent}),ct={setPanelAngularComponent:T.o8},ht=(0,D.connect)(dt,ct)(lt);var ut=a(29431),Ce=a(55294),Ae=a(46519),pt=a(5916),Pe=a(40400),mt=a(16911),gt=a(20231),ft=a(82378),Ne=a(35645),Ue=a(60325),ke=a(53546),we=a(29494),vt=a(91162),Et=a(30002),Fe=a(85854),Ct=a(66926);const Pt=(t,e,r)=>{const{overrides:n}=r,o=r.overrides.findIndex(E=>E.matcher.id===Fe.mi.byName&&E.matcher.options===t);if(o<0)return{...r,overrides:[...r.overrides,yt(t,e)]};const i=Array.from(n),l=i[o],h=l.properties.findIndex(E=>E.id==="color");if(h<0)return i[o]={...l,properties:[...l.properties,ye(e)]},{...r,overrides:i};const u=Array.from(l.properties);return u[h]=ye(e),i[o]={...l,properties:u},{...r,overrides:i}},yt=(t,e)=>({matcher:{id:Fe.mi.byName,options:t},properties:[ye(e)]}),ye=t=>({id:"color",value:{mode:Ct.S.Fixed,fixedColor:t}});var Dt=a(45984),De=a(70659),Se=a(87865),St=a(57277),It=a(91551),Ie=a(6911);const xt="Error in plugin";class Ot extends s.PureComponent{constructor(e){super(e),this.timeSrv=(0,U.$t)(),this.subs=new f.w0,this.eventFilter={onlyLocal:!0},this.getSync=()=>this.props.isEditing?ut.m.Off:this.props.dashboard.graphTooltip,this.onInstanceStateChange=n=>{this.props.onInstanceStateChange(n),this.setState({context:{...this.state.context,instanceState:n}})},this.onSeriesColorChange=(n,o)=>{this.onFieldConfigChange(Pt(n,o,this.props.panel.fieldConfig))},this.onSeriesVisibilityChange=(n,o)=>{this.onFieldConfigChange((0,It.N)(n,o,this.props.panel.fieldConfig,this.state.data.series))},this.onToggleLegendSort=n=>{const o=this.props.panel.options.legend;if(!o)return;let i=o.sortDesc,l=o.sortBy;n!==l&&(i=void 0),i===!1?(l=void 0,i=void 0):(i=!i,l=n),this.onOptionsChange({...this.props.panel.options,legend:{...o,sortBy:l,sortDesc:i}})},this.onRefresh=()=>{const{dashboard:n,panel:o,isInView:i,width:l}=this.props;if(!i){this.setState({refreshWhenInView:!0});return}const h=(0,he.W1)(o,this.timeSrv.timeRange());if(this.wantsQueryExecution){if(l<0)return;this.state.refreshWhenInView&&this.setState({refreshWhenInView:!1}),o.runAllPanelQueries({dashboardId:n.id,dashboardUID:n.uid,dashboardTimezone:n.getTimezone(),publicDashboardAccessToken:n.meta.publicDashboardAccessToken,timeData:h,width:l})}else this.setState({data:{...this.state.data,timeRange:this.timeSrv.timeRange()},renderCounter:this.state.renderCounter+1,liveTime:void 0})},this.onRender=()=>{const n={renderCounter:this.state.renderCounter+1};this.setState(n)},this.onOptionsChange=n=>{this.props.panel.updateOptions(n)},this.onFieldConfigChange=n=>{this.props.panel.updateFieldConfig(n)},this.onPanelError=n=>{const o=n.message||xt;this.state.errorMessage!==o&&this.setState({errorMessage:o})},this.onPanelErrorRecover=()=>{this.setState({errorMessage:void 0})},this.onAnnotationCreate=async n=>{const o=n.from!==n.to,i={dashboardUID:this.props.dashboard.uid,panelId:this.props.panel.id,isRegion:o,time:n.from,timeEnd:o?n.to:0,tags:n.tags,text:n.description};await(0,De.xD)(i),(0,Se.kt)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new Ce.n1(i))},this.onAnnotationDelete=async n=>{await(0,De.Dl)({id:n}),(0,Se.kt)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new Ce.n1({id:n}))},this.onAnnotationUpdate=async n=>{const o=n.from!==n.to,i={id:n.id,dashboardUID:this.props.dashboard.uid,panelId:this.props.panel.id,isRegion:o,time:n.from,timeEnd:o?n.to:0,tags:n.tags,text:n.description};await(0,De._E)(i),(0,Se.kt)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new Ce.n1(i))},this.onChangeTimeRange=n=>{this.timeSrv.setTime({from:(0,Ae.zh)(n.from),to:(0,Ae.zh)(n.to)})},this.onAddAdHocFilter=n=>{const{key:o,value:i,operator:l}=n,h=(0,vt.ak)().getInstanceSettings(this.props.panel.datasource),u=h&&(0,pt.iU)(h);u&&(0,Te.WI)((0,Et.m2)({datasource:u,key:o,operator:l,value:i}))};const r=e.dashboard.events.newScopedBus(`panel:${e.panel.id}`,this.eventFilter);this.state={isFirstLoad:!0,renderCounter:0,refreshWhenInView:!1,context:{eventBus:r,app:this.getPanelContextApp(),sync:this.getSync,onSeriesColorChange:this.onSeriesColorChange,onToggleSeriesVisibility:this.onSeriesVisibilityChange,onAnnotationCreate:this.onAnnotationCreate,onAnnotationUpdate:this.onAnnotationUpdate,onAnnotationDelete:this.onAnnotationDelete,onInstanceStateChange:this.onInstanceStateChange,onToggleLegendSort:this.onToggleLegendSort,canAddAnnotations:e.dashboard.canAddAnnotations.bind(e.dashboard),canEditAnnotations:e.dashboard.canEditAnnotations.bind(e.dashboard),canDeleteAnnotations:e.dashboard.canDeleteAnnotations.bind(e.dashboard),onAddAdHocFilter:this.onAddAdHocFilter},data:this.getInitialPanelDataState()}}getPanelContextApp(){return this.props.isEditing?Pe.zj.PanelEditor:this.props.isViewing?Pe.zj.PanelViewer:Pe.zj.Dashboard}getInitialPanelDataState(){return{state:c.Gu.NotStarted,series:[],timeRange:(0,C.JK)()}}componentDidMount(){const{panel:e,dashboard:r}=this.props;if(this.subs.add(e.events.subscribe(ft.U5,this.onRefresh)),this.subs.add(e.events.subscribe(Dt._z,this.onRender)),r.panelInitialized(this.props.panel),this.hasPanelSnapshot){this.setState({data:(0,St.y)(e,r),isFirstLoad:!1});return}this.wantsQueryExecution||this.setState({isFirstLoad:!1}),this.subs.add(e.getQueryRunner().getData({withTransforms:!0,withFieldConfig:!0}).subscribe({next:n=>this.onDataUpdate(n)})),Ie.A.listen(this)}componentWillUnmount(){this.subs.unsubscribe(),Ie.A.remove(this)}liveTimeChanged(e){const{data:r}=this.state;if(r.timeRange){const n=e.to.valueOf()-r.timeRange.to.valueOf();if(n<100){console.log("Skip tick render",this.props.panel.title,n);return}}this.setState({liveTime:e})}componentDidUpdate(e){const{isInView:r,width:n}=this.props,{context:o}=this.state,i=this.getPanelContextApp();o.app!==i&&this.setState({context:{...o,app:i}}),r!==e.isInView&&r&&this.state.refreshWhenInView&&this.onRefresh(),n!==e.width&&Ie.A.updateInterval(this)}onDataUpdate(e){const{dashboard:r,panel:n,plugin:o}=this.props;if(o.meta.skipDataQuery){this.setState({data:this.getInitialPanelDataState()});return}let{isFirstLoad:i}=this.state,l;switch(e.state){case c.Gu.Loading:if(this.state.data.state===c.Gu.Loading)return;break;case c.Gu.Error:const{error:h,errors:u}=e;u?.length?u.length===1?l=u[0].message:l="Multiple errors found. Click for more details":h&&l!==h.message&&(l=h.message);break;case c.Gu.Done:r.snapshot&&(n.snapshotData=e.series.map(E=>(0,mt.og)(E))),i&&(i=!1);break}this.setState({isFirstLoad:i,errorMessage:l,data:e,liveTime:void 0})}get hasPanelSnapshot(){const{panel:e}=this.props;return e.snapshotData&&e.snapshotData.length}get wantsQueryExecution(){return!(this.props.plugin.meta.skipDataQuery||this.hasPanelSnapshot)}shouldSignalRenderingCompleted(e,r){return e===c.Gu.Done||e===c.Gu.Error||r.skipDataQuery}skipFirstRender(e){const{isFirstLoad:r}=this.state;return this.wantsQueryExecution&&r&&(e===c.Gu.Loading||e===c.Gu.NotStarted)}renderPanelContent(e,r){const{panel:n,plugin:o,dashboard:i}=this.props,{renderCounter:l,data:h}=this.state,{state:u}=h;if(this.skipFirstRender(u))return null;this.shouldSignalRenderingCompleted(u,o.meta)&&we.r.renderingCompleted();const E=o.panel,O=this.state.liveTime??h.timeRange??this.timeSrv.timeRange(),N=n.getOptions();return this.eventFilter.onlyLocal=i.graphTooltip===0,s.createElement(s.Fragment,null,s.createElement(Ue._w,{value:this.state.context},s.createElement(E,{id:n.id,data:h,title:n.title,timeRange:O,timeZone:this.props.dashboard.getTimezone(),options:N,fieldConfig:n.fieldConfig,transparent:n.transparent,width:e,height:r,renderCounter:l,replaceVariables:n.replaceVariables,onOptionsChange:this.onOptionsChange,onFieldConfigChange:this.onFieldConfigChange,onChangeTimeRange:this.onChangeTimeRange,eventBus:i.events})))}renderPanel(e,r){const{panel:n,plugin:o,dashboard:i}=this.props,{renderCounter:l,data:h}=this.state,{theme:u}=Ne.v,{state:E}=h;if(this.skipFirstRender(E))return null;this.shouldSignalRenderingCompleted(E,o.meta)&&we.r.renderingCompleted();const O=o.panel,N=this.state.liveTime??h.timeRange??this.timeSrv.timeRange(),j=this.hasOverlayHeader()?0:u.panelHeaderHeight,q=o.noPadding?0:u.panelPadding,$=e-q*2-m.QO,F=r-j-q*2-m.QO,w=L()({"panel-content":!0,"panel-content--no-padding":o.noPadding}),R=n.getOptions();this.eventFilter.onlyLocal=i.graphTooltip===0;const ie=this.props.timezone||this.props.dashboard.getTimezone();return s.createElement(s.Fragment,null,s.createElement("div",{className:w},s.createElement(gt.b,{meta:o.meta},s.createElement(Ue._w,{value:this.state.context},s.createElement(O,{id:n.id,data:h,title:n.title,timeRange:N,timeZone:ie,options:R,fieldConfig:n.fieldConfig,transparent:n.transparent,width:$,height:F,renderCounter:l,replaceVariables:n.replaceVariables,onOptionsChange:this.onOptionsChange,onFieldConfigChange:this.onFieldConfigChange,onChangeTimeRange:this.onChangeTimeRange,eventBus:i.events})))))}hasOverlayHeader(){const{panel:e}=this.props,{data:r}=this.state;return r.request&&r.request.timeInfo?!1:!e.hasTitle()}render(){const{dashboard:e,panel:r,isViewing:n,isEditing:o,width:i,height:l,plugin:h}=this.props,{errorMessage:u,data:E}=this.state,{transparent:O}=r,N=E.alertState?.state,j=this.hasOverlayHeader(),q=L()({"panel-container":!0,"panel-container--absolute":W(M.E1.getLocation().pathname),"panel-container--transparent":O,"panel-container--no-title":j,[`panel-alert-state--${N}`]:N!==void 0}),$=oe({...this.props,data:E});if(Ne.v.featureToggles.newPanelChromeUI){const F=(r.gridPos?.y??0)===0?-16:void 0,w=s.createElement("div",{"data-testid":"panel-dropdown"},s.createElement(be,{panel:r,dashboard:e,loadingState:E.state}));return s.createElement(H.fm,{width:i,height:l,title:$.title,loadingState:E.state,statusMessage:u,statusMessageOnClick:$.onOpenErrorInspect,description:$.description,titleItems:$.titleItems,menu:this.props.hideMenu?void 0:w,dragClass:$.dragClass,dragClassCancel:"grid-drag-cancel",padding:$.padding,hoverHeaderOffset:F,hoverHeader:$.hasOverlayHeader(),displayMode:O?"transparent":"default",onCancelQuery:$.onCancelQuery,onOpenMenu:$.onOpenMenu},(R,ie)=>s.createElement(s.Fragment,null,s.createElement(ke.SV,{dependencies:[E,h,r.getOptions()],onError:this.onPanelError,onRecover:this.onPanelErrorRecover},({error:pe})=>pe?null:this.renderPanelContent(R,ie))))}else return s.createElement("section",{className:q,"aria-label":p.wl.components.Panels.Panel.containerByTitle(r.title)},s.createElement(Le,{panel:r,dashboard:e,title:r.title,description:r.description,links:r.links,error:u,isEditing:o,isViewing:n,alertState:N,data:E}),s.createElement(ke.SV,{dependencies:[E,h,r.getOptions()],onError:this.onPanelError,onRecover:this.onPanelErrorRecover},({error:F})=>F?null:this.renderPanel(i,l)))}}const Mt=(t,e)=>{const r=t.panels[e.stateKey];return r?{plugin:r.plugin,instanceState:r.instanceState}:{plugin:null}},Tt={initPanelState:Z.JI,setPanelInstanceState:T.pC},Rt=(0,D.connect)(Mt,Tt);class He extends s.PureComponent{constructor(){super(...arguments),this.onInstanceStateChange=e=>{this.props.setPanelInstanceState({key:this.props.stateKey,value:e})},this.onVisibilityChange=e=>{this.props.panel.isInView=e},this.onPanelLoad=()=>{this.props.plugin||this.props.initPanelState(this.props.panel)},this.renderPanel=e=>{const{dashboard:r,panel:n,isViewing:o,isEditing:i,width:l,height:h,plugin:u,timezone:E,hideMenu:O}=this.props;return u?u&&u.angularPanelCtrl?s.createElement(ht,{plugin:u,panel:n,dashboard:r,isViewing:o,isEditing:i,isInView:e,width:l,height:h}):s.createElement(Ot,{plugin:u,panel:n,dashboard:r,isViewing:o,isEditing:i,isInView:e,width:l,height:h,onInstanceStateChange:this.onInstanceStateChange,timezone:E,hideMenu:O}):null}}componentDidMount(){this.props.panel.isInView=!this.props.lazy,this.props.lazy||this.onPanelLoad()}render(){const{width:e,height:r,lazy:n}=this.props;return n?s.createElement(d,{width:e,height:r,onChange:this.onVisibilityChange,onLoad:this.onPanelLoad},this.renderPanel):this.renderPanel(!0)}}He.defaultProps={lazy:!0};const bt=Rt(He)},53821:(le,z,a)=>{a.d(z,{Z:()=>c});var s=a(68404),D=a(41959),Z=a(68183),T=a(20308),Y=a(37932),J=a(6554),d=a(19349),b=a(39653),L=(C=>(C.Error="Error",C.Info="Info",C.Links="Links",C))(L||{});class f extends s.Component{constructor(){super(...arguments),this.timeSrv=(0,d.$t)(),this.getInfoMode=()=>{const{panel:p,error:y}=this.props;if(y)return"Error";if(p.description)return"Info";if(p.links&&p.links.length)return"Links"},this.getInfoContent=()=>{const{panel:p}=this.props,y=p.description||"",M=(0,T.J)().replace(y,p.scopedVars),H=(0,D.a)(M),S=this.props.links&&this.props.links.getLinks(p.replaceVariables);return s.createElement("div",{className:"panel-info-content markdown-html"},s.createElement("div",{dangerouslySetInnerHTML:{__html:H}}),S&&S.length>0&&s.createElement("ul",{className:"panel-info-corner-links"},S.map((m,I)=>s.createElement("li",{key:I},s.createElement("a",{className:"panel-info-corner-links__item",href:m.href,target:m.target},m.title)))))},this.onClickError=()=>{Y.E1.partial({inspect:this.props.panel.id,inspectTab:b.q.Error})}}renderCornerType(p,y,M){const H=p==="Error"?"error":"info",S=`panel-info-corner panel-info-corner--${p.toLowerCase()}`,m=Z.wl.components.Panels.Panel.headerCornerInfo(p.toLowerCase());return s.createElement(J.u,{content:y,placement:"top-start",theme:H,interactive:!0},s.createElement("button",{type:"button",className:S,onClick:M,"aria-label":m},s.createElement("i",{"aria-hidden":!0,className:"fa"}),s.createElement("span",{className:"panel-info-corner-inner"})))}render(){const{error:p}=this.props,y=this.getInfoMode();return y?y==="Error"&&p?this.renderCornerType(y,p,this.onClickError):y==="Info"||y==="Links"?this.renderCornerType(y,this.getInfoContent):null:null}}const c=f},91551:(le,z,a)=>{a.d(z,{N:()=>f});var s=a(68061),D=a(74188),Z=a(85854),T=a(14582),Y=a(89890),J=a(3249),d=a(17882);const b="hideSeriesFrom",L=(0,s.Y4)(b);function f(S,m,I,W){const{overrides:K}=I,U=S,_=K.findIndex(L);if(_<0){if(m===d.R.ToggleSelection){const re=c([U,...H(K,W)]);return{...I,overrides:[...I.overrides,re]}}const ne=M(W,U),k=c(ne);return{...I,overrides:[...I.overrides,k]}}const X=Array.from(K),[x]=X.splice(_,1);if(m===d.R.ToggleSelection){let ne=p(x);const k=H(X,W);if(k.length>0&&(ne=ne.filter(se=>k.indexOf(se)<0)),ne[0]===U&&ne.length===1)return{...I,overrides:X};const re=c([U,...k]);return{...I,overrides:[...X,re]}}const Q=C(x,U);return y(Q,W)?{...I,overrides:X}:{...I,overrides:[...X,Q]}}function c(S,m=D.Ys.exclude,I){return I=I??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:b,matcher:{id:Z.mi.byNames,options:{mode:m,names:S,prefix:m===D.Ys.exclude?"All except:":void 0,readOnly:!0}},properties:[{...I,value:{viz:!0,legend:!1,tooltip:!1}}]}}const C=(S,m,I=D.Ys.exclude)=>{const W=S.properties.find(_=>_.id==="custom.hideFrom"),K=p(S),U=K.findIndex(_=>_===m);return U<0?K.push(m):K.splice(U,1),c(K,I,W)},p=S=>{const m=S.matcher.options?.names;return Array.isArray(m)?[...m]:[]},y=(S,m)=>p(S).length===M(m).length,M=(S,m)=>{const I=new Set;for(const W of S)for(const K of W.fields){if(K.type!==T.fS.number)continue;const U=(0,Y.C)(K,W,S);U!==m&&I.add(U)}return Array.from(I)},H=(S,m)=>{let I=[];for(const W of S){const K=W.properties.find(U=>U.id==="custom.hideFrom");if(K!==void 0&&K.value?.legend===!0){const _=J.Ls.get(W.matcher.id).get(W.matcher.options);for(const X of m)for(const x of X.fields){if(x.type!==T.fS.number)continue;const Q=(0,Y.C)(x,X,m);_(x,X,m)&&I.push(Q)}}}return I}},6911:(le,z,a)=>{a.d(z,{A:()=>b});var s=a(924),D=a(46519),Z=a(21053);const T=100;class Y{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new s.X(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const f=Date.now();this.budget=(f-this.lastUpdate)/T;const c=this.ok.getValue(),C=this.budget<=this.threshold;if(c!==C&&this.ok.next(C),this.lastUpdate=f,this.isLive&&this.ok.getValue()&&this.timeRange){let p;for(const y of this.listeners){if(!y.panel.props.isInView)continue;if(f-y.last>=y.intervalMs){if(!p){const{raw:H}=this.timeRange;p={raw:H,from:(0,D.CQ)(f-this.liveTimeOffset),to:(0,D.CQ)(f)}}y.panel.liveTimeChanged(p),y.last=f}}}}}setLiveTimeRange(f){if(this.timeRange=f,this.isLive=f?.raw?.to==="now",this.isLive){const c=Z.parse(f.raw.from,!1)?.valueOf(),C=Z.parse(f.raw.to,!0)?.valueOf();this.liveTimeOffset=C-c;for(const p of this.listeners)p.intervalMs=d(this.liveTimeOffset,p.panel.props.width)}}listen(f){this.listeners.push({last:this.lastUpdate,panel:f,intervalMs:d(6e4,f.props.width)})}remove(f){this.listeners=this.listeners.filter(c=>c.panel!==f)}updateInterval(f){if(!(!this.timeRange||!this.isLive)){for(const c of this.listeners)if(c.panel===f){c.intervalMs=d(this.liveTimeOffset,c.panel.props.width);return}}}}const J=5*60*1e3;function d(L,f){const c=Math.ceil(L/f/100)*100;return c>J?J:c}const b=new Y;setInterval(b.measure,T)},87464:(le,z,a)=>{a.d(z,{ZQ:()=>se,mV:()=>re,f1:()=>fe,$M:()=>ae});var s=a(83383),D=a(46519),Z=a(55294),T=a(37932),Y=a(54899),J=a(35645),d=a(659),b=a(18271),L=a(60499),f=a(29930),c=a(58379),C=a(87449),p=a(9398),y=a(19349),M=a(30992),H=a(10079),S=a(92624),m=a(81168),I=a(87865),W=a(85803),K=a(87095),U=a(82302),_=a(75552),X=a(41818);function x(P){const A={dashboardId:P.id,dashboardName:P.title,dashboardUid:P.uid,folderName:P.meta.folderTitle,eventName:_.ct.DashboardView};(0,X.r_)(A)}var Q=a(58790);async function ne(P,A,G){const V=c.Z.getObject(de);if(V)return fe(),V;try{switch(P.routeName){case m.DashboardRoutes.Home:{const v=await f.ae.get("/api/dashboards/home");if(v.redirectUri){const ee=s.u.stripBaseFromUrl(v.redirectUri);return T.E1.replace(ee),null}return v.meta.canSave=!1,v.meta.canShare=!1,v.meta.canStar=!1,v}case m.DashboardRoutes.Public:return await C.pD.loadDashboard("public",P.urlSlug,P.accessToken);case m.DashboardRoutes.Normal:{const v=await C.pD.loadDashboard(P.urlType,P.urlSlug,P.urlUid);if(P.fixUrl&&v.meta.url&&!H.r0.isPlaying){const ee=s.u.stripBaseFromUrl(v.meta.url),ce=T.E1.getLocation().pathname;ee!==ce&&(T.E1.replace({...T.E1.getLocation(),pathname:ee}),console.log("not correct url correcting",ee,ce))}return v}case m.DashboardRoutes.New:return se(P.urlFolderUid,P.panelType);case m.DashboardRoutes.Path:{const v=P.urlSlug??"";return await C.pD.loadDashboard(m.DashboardRoutes.Path,v,v)}default:throw{message:"Unknown route "+P.routeName}}}catch(v){return(0,Y.kW)(v)&&v.cancelled||(A((0,Q.jA)({message:"Failed to fetch dashboard",error:v})),console.error(v)),null}}const k=(P,A={})=>(P.forEach(G=>{G.panels?k(G.panels,A):G.targets&&G.targets.forEach(V=>{V.datasource?.type&&(A[V.datasource.type]?A[V.datasource.type].push(V):A[V.datasource.type]=[V])})}),A);function re(P){return async(A,G)=>{A((0,Q.sf)());const V=await ne(P,A,G);if(!V)return;A((0,Q.Nv)());let v;try{v=new U.f(V.dashboard,V.meta)}catch(oe){A((0,Q.jA)({message:"Failed create dashboard model",error:oe})),console.error(oe);return}const ee=G(),ce=T.E1.getSearchObject();ce.orgId||T.E1.partial({orgId:ee.user.orgId},!0);const ge=(0,y.$t)();(0,p.h4)().setCurrent(v),ge.init(v);const ve=(0,S.mn)(P.urlUid??v.uid);if(await A((0,W.LX)(ve,v)),(0,I.Tl)({dashboard:v,timeSrv:ge}).run({dashboard:v,range:ge.timeRange()}),(0,K.cp)(G())===ve&&G().dashboard.initPhase===m.DashboardInitPhase.Services){try{v.processRepeats(),ce.autofitpanels&&v.autoFitPanels(window.innerHeight,ce.kiosk),P.keybindingSrv.setupDashboardBindings(v)}catch(oe){oe instanceof Error&&A((0,d.$l)((0,L.t_)("Dashboard init failed",oe))),console.error(oe)}P.routeName!==m.DashboardRoutes.New?(x(v),M.H.watch(v.uid)):M.H.leave(),v.weekStart!==""?(0,D.Ls)(v.weekStart):(0,D.Ls)(J.v.bootData.user.weekStart),b.Z.publish(new Z.Pl({dashboardId:v.uid,orgId:ee.user.orgId,userId:ee.user.user?.id,grafanaVersion:J.v.buildInfo.version,queries:k(v.panels)})),A((0,Q.dS)(v))}}}function se(P,A){const G=J.v.featureToggles.emptyDashboardPage?[]:[{type:A??"add-panel",gridPos:{x:0,y:0,w:12,h:9},title:"Panel Title"}],V={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{title:"New dashboard",panels:G}};return P&&(V.meta.folderUid=P),V}const de="DASHBOARD_FROM_LS_KEY";function ae(P){c.Z.setObject(de,P)}function fe(){c.Z.delete(de)}},57277:(le,z,a)=>{a.d(z,{y:()=>f});var s=a(16911),D=a(69311),Z=a(71398),T=a(49922),Y=a(36998),J=a(47694),d=a(56422),b=a(19349),L=a(2476);function f(c,C){const p=(0,s.F9)(c.snapshotData),y=new d.g,M={dashboard:C,range:(0,D.JK)()},H=y.canWork(M)?y.getAnnotationsInSnapshot(C,c.id):[],S=[new Z.i(H)];return{timeRange:(0,L.W1)(c,(0,b.$t)().timeRange()).timeRange,state:T.Gu.Done,series:(0,Y.SM)({data:p,fieldConfig:{defaults:{},overrides:[]},replaceVariables:c.replaceVariables,fieldConfigRegistry:c.plugin.fieldConfigRegistry,theme:J.vc.theme2,timeZone:C.getTimezone()}),annotations:S}}},39653:(le,z,a)=>{a.d(z,{q:()=>s});var s=(D=>(D.Data="data",D.Meta="meta",D.Error="error",D.Stats="stats",D.JSON="json",D.Query="query",D.Help="help",D))(s||{})},69600:(le,z,a)=>{a.d(z,{H:()=>J,n:()=>Y});var s=a(16911),D=a(20112),Z=a(94847),T=a(64703);const Y=d=>{const b=d.field.links;if(!(!b||b.length===0))return{getLinks:L=>{const f={};if(d.view){const{dataFrame:C}=d.view;f.__series={value:{name:C.name,refId:C.refId},text:"Series"};const p=d.colIndex!==void 0?C.fields[d.colIndex]:void 0;if(p){if(f.__field={value:{name:p.name,labels:p.labels},text:"Field"},d.rowIndex!==void 0&&d.rowIndex>=0){const{timeField:y}=(0,s.sV)(C);f.__value={value:{raw:p.values.get(d.rowIndex),numeric:d.display.numeric,text:(0,D.zc)(d.display),time:y?y.values.get(d.rowIndex):void 0},text:"Value"}}d.view&&(f.__data={value:{name:C.name,refId:C.refId,fields:(0,Z.z)({frame:C,rowIndex:d.rowIndex})},text:"Data"})}else f.__value={value:{raw:d.display.numeric,numeric:d.display.numeric,text:(0,D.zc)(d.display),calc:d.name},text:"Value"}}else console.log("VALUE",d);const c=(C,p,y)=>{const M={...f,...p};return L(C,M,y)};return b.map(C=>(0,T.Bq)().getDataLinkUIModel(C,c,d))}}},J=d=>{const b=d.links;if(!(!b||b.length===0))return{getLinks:()=>b.map(L=>(0,T.Bq)().getDataLinkUIModel(L,d.replaceVariables,d))}}},73952:(le,z,a)=>{a.d(z,{i:()=>s});function s(D,Z){return D.panels[Z.key]}}}]);

//# sourceMappingURL=7362.f69d65b9f97d6faad0a7.js.map